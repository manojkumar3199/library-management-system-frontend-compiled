"use strict";(self.webpackChunklibrary_management_system=self.webpackChunklibrary_management_system||[]).push([[944],{8944:(Y,h,i)=>{i.r(h),i.d(h,{BookAddModule:()=>d});var g=i(6895),B=i(9299),u=i(4006),o=i(4650),_=i(2507),T=i(608),Z=i(2882),p=i(7009),m=i(9549),f=i(4144),A=i(4859),k=i(8425),v=i(4385),x=i(3238);const C=["formGroupDirective"];function b(l,t){if(1&l&&(o.TgZ(0,"div",4)(1,"strong"),o._uU(2,"Error: "),o.qZA(),o._uU(3),o.qZA()),2&l){const r=o.oxw();o.xp6(3),o.AsE("",null==r.error.error?null:r.error.error.error," ",null==r.error.error?null:r.error.error.message,"\n")}}function y(l,t){1&l&&o._uU(0,"Fill Out Your Book Details")}function S(l,t){if(1&l&&(o.TgZ(0,"mat-option",31),o.ALo(1,"json"),o._uU(2),o.qZA()),2&l){const r=t.$implicit;o.s9C("value",o.lcZ(1,2,r)),o.xp6(2),o.hij(" ",r.categoryName,"")}}function N(l,t){1&l&&(o.TgZ(0,"mat-error"),o._uU(1," Please "),o.TgZ(2,"Strong"),o._uU(3,"Select"),o.qZA(),o._uU(4," The Book category "),o.qZA())}function U(l,t){1&l&&(o.TgZ(0,"mat-error"),o._uU(1," Book Title Is "),o.TgZ(2,"strong"),o._uU(3,"Required"),o.qZA()())}function I(l,t){if(1&l&&(o.TgZ(0,"mat-error"),o._uU(1," Book Title Should Have "),o.TgZ(2,"strong"),o._uU(3),o.qZA()()),2&l){const r=o.oxw(2);o.xp6(3),o.hij(" At Least ",null==r.getBookTitle||null==r.getBookTitle.errors||null==r.getBookTitle.errors.minlength?null:r.getBookTitle.errors.minlength.requiredLength," Chars ")}}function F(l,t){1&l&&(o.TgZ(0,"mat-error"),o._uU(1," Book Author Is "),o.TgZ(2,"strong"),o._uU(3,"Required"),o.qZA()())}function J(l,t){if(1&l&&(o.TgZ(0,"mat-error"),o._uU(1," Book Author Should Have "),o.TgZ(2,"strong"),o._uU(3),o.qZA()()),2&l){const r=o.oxw(2);o.xp6(3),o.hij(" At Least ",null==r.getBookAuthor||null==r.getBookAuthor.errors?null:r.getBookAuthor.errors.minlength.requiredLength," Chars ")}}function q(l,t){if(1&l){const r=o.EpF();o.TgZ(0,"div",0)(1,"mat-stepper",5,6)(3,"mat-step",7,8)(5,"div",9)(6,"form",10,11),o.NdJ("ngSubmit",function(){o.CHM(r);const n=o.MAs(2),s=o.oxw();return o.KtG(s.saveNewBook(n))}),o.YNc(8,y,1,0,"ng-template",12),o.TgZ(9,"mat-form-field",13)(10,"mat-label"),o._uU(11,"Book category"),o.qZA(),o.TgZ(12,"mat-select",14),o.YNc(13,S,3,4,"mat-option",15),o.qZA(),o.YNc(14,N,5,0,"mat-error",16),o.qZA(),o.TgZ(15,"mat-form-field",13)(16,"mat-label"),o._uU(17,"Book title"),o.qZA(),o._UZ(18,"input",17),o.YNc(19,U,4,0,"mat-error",16),o.YNc(20,I,4,1,"mat-error",16),o.qZA(),o.TgZ(21,"mat-form-field",13)(22,"mat-label"),o._uU(23,"Book author"),o.qZA(),o._UZ(24,"input",18),o.YNc(25,F,4,0,"mat-error",16),o.YNc(26,J,4,1,"mat-error",16),o.qZA(),o.TgZ(27,"mat-form-field",13)(28,"mat-label"),o._uU(29,"Description"),o.qZA(),o._UZ(30,"textarea",19),o.qZA(),o.TgZ(31,"div",20)(32,"button",21),o._uU(33,"Save"),o.qZA(),o.TgZ(34,"button",22),o.NdJ("click",function(){o.CHM(r);const n=o.MAs(2),s=o.oxw();return o.KtG(s.reset(n))}),o._uU(35,"Reset"),o.qZA()()()()(),o.TgZ(36,"mat-step",23)(37,"div",9)(38,"button",24),o.NdJ("click",function(){o.CHM(r);const n=o.MAs(41);return o.KtG(n.click())}),o._uU(39,"Choose File"),o.qZA(),o.TgZ(40,"input",25,26),o.NdJ("change",function(n){o.CHM(r);const s=o.oxw();return o.KtG(s.onFileSelect(n))}),o.qZA(),o.TgZ(42,"span",27),o._uU(43),o.qZA()(),o.TgZ(44,"div",20)(45,"button",28),o.NdJ("click",function(){o.CHM(r);const n=o.MAs(2),s=o.oxw();return o.KtG(s.saveBookImage(n))}),o._uU(46,"Upload"),o.qZA(),o.TgZ(47,"button",22),o.NdJ("click",function(){o.CHM(r);const n=o.MAs(2),s=o.oxw();return o.KtG(s.skipImageUploading(n))}),o._uU(48,"Skip"),o.qZA()()(),o.TgZ(49,"mat-step",29)(50,"div",30),o._uU(51," Your Book Is Added Successfully! "),o.qZA()()()()}if(2&l){const r=o.MAs(4),e=o.oxw();o.xp6(1),o.Q6J("linear",!0),o.xp6(2),o.Q6J("stepControl",e.addNewBookForm)("editable",e.firstStep),o.xp6(3),o.Q6J("formGroup",e.addNewBookForm),o.xp6(7),o.Q6J("ngForOf",e.categories),o.xp6(1),o.Q6J("ngIf",(null==e.getBookCategory?null:e.getBookCategory.invalid)&&(null==e.getBookCategory?null:e.getBookCategory.touched)||r.interacted&&(null==e.getBookCategory?null:e.getBookCategory.invalid)&&(null==e.getBookCategory?null:e.getBookCategory.untouched)),o.xp6(5),o.Q6J("ngIf",(null==e.getBookTitle||null==e.getBookTitle.errors?null:e.getBookTitle.errors.required)&&(null==e.getBookTitle?null:e.getBookTitle.touched)||r.interacted&&(null==e.getBookTitle?null:e.getBookTitle.untouched)&&(null==e.getBookTitle||null==e.getBookTitle.errors?null:e.getBookTitle.errors.required)),o.xp6(1),o.Q6J("ngIf",(null==e.getBookTitle||null==e.getBookTitle.errors?null:e.getBookTitle.errors.minlength)&&(null==e.getBookTitle?null:e.getBookTitle.touched)||r.interacted&&(null==e.getBookTitle?null:e.getBookTitle.untouched)&&(null==e.getBookTitle||null==e.getBookTitle.errors?null:e.getBookTitle.errors.minlength)),o.xp6(5),o.Q6J("ngIf",(null==e.getBookAuthor||null==e.getBookAuthor.errors?null:e.getBookAuthor.errors.required)&&(null==e.getBookAuthor?null:e.getBookAuthor.touched)||r.interacted&&(null==e.getBookAuthor?null:e.getBookAuthor.untouched)&&(null==e.getBookAuthor||null==e.getBookAuthor.errors?null:e.getBookAuthor.errors.required)),o.xp6(1),o.Q6J("ngIf",(null==e.getBookAuthor||null==e.getBookAuthor.errors?null:e.getBookAuthor.errors.minlength)&&(null==e.getBookAuthor?null:e.getBookAuthor.touched)||r.interacted&&(null==e.getBookAuthor?null:e.getBookAuthor.untouched)&&(null==e.getBookAuthor||null==e.getBookAuthor.errors?null:e.getBookAuthor.errors.minlength)),o.xp6(6),o.Q6J("disabled",e.addNewBookForm.invalid),o.xp6(4),o.Q6J("editable",e.secondStep),o.xp6(7),o.Oqu(null==e.selectedFile?null:e.selectedFile.name),o.xp6(2),o.Q6J("disabled",!e.selectedFile||!e.currentSavedBook)}}class c{constructor(t,r,e,n,s){this.categoryService=t,this.bookService=r,this.storeService=e,this.fb=n,this._snackBar=s,this.categories=[],this.selectedFile=null,this.error=null,this.loaded=!1,this.firstStep=!0,this.secondStep=!0,this.currentSavedBook=null}ngOnInit(){this.storeService.loaded?this.storeService.loadCategories().subscribe(t=>{this.categories=t,this.loaded=!0}):this.categoryService.getCategories().subscribe({next:t=>{this.storeService.setCategories(t),this.categories=t,this.loaded=!0},error:t=>{console.log(t),this.error=t}}),this.addNewBookForm=this.fb.group({category:[null,u.kI.required],title:["",[u.kI.required,u.kI.minLength(3)]],author:["",[u.kI.required,u.kI.minLength(3)]],description:[null]})}get getBookCategory(){return this.addNewBookForm.get("category")}get getBookTitle(){return this.addNewBookForm.get("title")}get getBookAuthor(){return this.addNewBookForm.get("author")}saveNewBook(t){null!==this.error&&(this.error=null),"string"==typeof this.addNewBookForm.value.category&&(this.addNewBookForm.value.category=JSON.parse(this.addNewBookForm.value.category)),this.bookService.saveNewBook(this.addNewBookForm.value).subscribe({next:e=>{this._snackBar.open(e.title+" added successfully!","",{duration:3e3}),this.storeService.addBook(e),this.storeService.incrementBook(),this.currentSavedBook=e,this.firstStep=!1,t.next()},error:e=>{console.log(e),this.error=e}})}reset(t){t.reset(),this.formGroupDirective.resetForm(),this.error=null}onFileSelect(t){this.selectedFile=t.target.files[0]??null}saveBookImage(t){null!==this.error&&(this.error=null);let r=this.currentSavedBook?.id;this.bookService.saveBookImage(r,this.selectedFile).subscribe({next:n=>{this._snackBar.open("Image Uploaded Successfully!","",{duration:3e3}),this.storeService.addBookImage(r,n),this.secondStep=!1,t.next()},error:n=>{console.log(n),this.error=n}})}skipImageUploading(t){null!==this.error&&(this.error=null),this.secondStep=!1,t.next()}}c.\u0275fac=function(t){return new(t||c)(o.Y36(_.H),o.Y36(T.Z),o.Y36(Z.d),o.Y36(u.qu),o.Y36(p.ux))},c.\u0275cmp=o.Xpm({type:c,selectors:[["app-book-add"]],viewQuery:function(t,r){if(1&t&&o.Gf(C,5),2&t){let e;o.iGM(e=o.CRH())&&(r.formGroupDirective=e.first)}},decls:6,vars:2,consts:[[1,"container","mt-3","p-3","bg-white"],[1,"fs-4","fw-bold"],["class","container mt-3 alert alert-danger",4,"ngIf"],["class","container mt-3 p-3 bg-white",4,"ngIf"],[1,"container","mt-3","alert","alert-danger"],["orientation","vertical",3,"linear"],["stepper",""],[3,"stepControl","editable"],["step",""],[1,"d-flex","justify-content-center","mt-5"],[1,"d-flex","flex-column",3,"formGroup","ngSubmit"],["formGroupDirective","ngForm"],["matStepLabel",""],["appearance","outline",1,"mb-4"],["formControlName","category"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","placeholder","e.g: Effective Java","formControlName","title"],["matInput","","placeholder","e.g: Joshua Bloch","formControlName","author"],["matInput","","placeholder","It's a perfect book for beginners...","formControlName","description"],[1,"d-flex","justify-content-between"],["type","submit","mat-raised-button","","color","primary",3,"disabled"],["type","button","mat-raised-button","","color","accent",3,"click"],["label","Add Book Image",3,"editable"],["mat-raised-button","",3,"click"],["hidden","","type","file",3,"change"],["fileInput",""],[1,"align-self-center","ms-4"],["type","button","mat-raised-button","","color","primary",3,"disabled","click"],["label","Done"],[1,"alert","alert-success","mt-5"],[3,"value"]],template:function(t,r){1&t&&(o.TgZ(0,"div",0)(1,"p",1),o._uU(2,"Add New Book"),o.qZA(),o._UZ(3,"hr"),o.qZA(),o.YNc(4,b,4,2,"div",2),o.YNc(5,q,52,14,"div",3)),2&t&&(o.xp6(4),o.Q6J("ngIf",r.error),o.xp6(1),o.Q6J("ngIf",r.loaded))},dependencies:[g.sg,g.O5,m.KE,m.hX,m.TO,f.Nt,A.lW,k.C0,k.VY,k.Vq,v.gD,x.ey,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u,g.Ts]});const w=[{path:"",component:c}];class a{}a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=o.oAB({type:a}),a.\u0275inj=o.cJS({imports:[B.Bz.forChild(w),B.Bz]});var M=i(7392);class d{}d.\u0275fac=function(t){return new(t||d)},d.\u0275mod=o.oAB({type:d}),d.\u0275inj=o.cJS({imports:[g.ez,a,m.lN,f.c,A.ot,M.Ps,k.T5,v.LD,u.UX,p.ZX]})}}]);