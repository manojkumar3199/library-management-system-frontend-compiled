"use strict";(self.webpackChunklibrary_management_system=self.webpackChunklibrary_management_system||[]).push([[828],{4828:(Q,f,l)=>{l.r(f),l.d(f,{BookEditModule:()=>u});var d=l(6895),h=l(9299),n=l(4006),t=l(4650),v=l(608),T=l(2507),Z=l(2882),k=l(7009),g=l(9549),p=l(4144),B=l(4385),A=l(3238),_=l(4859);const x=["formGroupDirective"],C=["fileInput"];function I(r,o){if(1&r&&(t.TgZ(0,"div",4)(1,"strong"),t._uU(2,"Error: "),t.qZA(),t._uU(3),t.qZA()),2&r){const e=t.oxw();t.xp6(3),t.AsE("",null==e.error.error?null:e.error.error.error," ",null==e.error.error?null:e.error.error.message,"\n")}}function b(r,o){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Category is "),t.TgZ(2,"Strong"),t._uU(3,"Required"),t.qZA()())}function y(r,o){if(1&r&&(t.TgZ(0,"mat-option",28),t._uU(1),t.qZA()),2&r){const e=o.$implicit;t.Q6J("value",e),t.xp6(1),t.hij("",e.categoryName," ")}}function U(r,o){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Please "),t.TgZ(2,"Strong"),t._uU(3,"Select"),t.qZA(),t._uU(4," The Book category "),t.qZA())}function E(r,o){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Book Title Is "),t.TgZ(2,"strong"),t._uU(3,"Required"),t.qZA()())}function F(r,o){if(1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Book Title Should Have "),t.TgZ(2,"strong"),t._uU(3),t.qZA()()),2&r){const e=t.oxw(2);t.xp6(3),t.hij(" At Least ",null==e.getBookTitle||null==e.getBookTitle.errors||null==e.getBookTitle.errors.minlength?null:e.getBookTitle.errors.minlength.requiredLength," Chars ")}}function q(r,o){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Book Author Is "),t.TgZ(2,"strong"),t._uU(3,"Required"),t.qZA()())}function J(r,o){if(1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Book Author Should Have "),t.TgZ(2,"strong"),t._uU(3),t.qZA()()),2&r){const e=t.oxw(2);t.xp6(3),t.hij(" At Least ",null==e.getBookAuthor||null==e.getBookAuthor.errors?null:e.getBookAuthor.errors.minlength.requiredLength," Chars ")}}function S(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"img",9),t.NdJ("error",function(s){t.CHM(e);const m=t.oxw();return t.KtG(m.setDefaultImage(s))}),t.qZA(),t.TgZ(5,"button",10),t.NdJ("click",function(){t.CHM(e);const s=t.MAs(8);return t.KtG(s.click())}),t._uU(6,"Browse Image"),t.qZA(),t.TgZ(7,"input",11,12),t.NdJ("change",function(s){t.CHM(e);const m=t.oxw();return t.KtG(m.onFileSelect(s))}),t.qZA(),t.TgZ(9,"button",13),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.updateImage())}),t._uU(10,"Change Image"),t.qZA()()(),t.TgZ(11,"div",14)(12,"form",15,16)(14,"mat-form-field",17)(15,"mat-label"),t._uU(16,"Book Id"),t.qZA(),t._UZ(17,"input",18),t.YNc(18,b,4,0,"mat-error",19),t.qZA(),t.TgZ(19,"mat-form-field",17)(20,"mat-label"),t._uU(21,"Book Category"),t.qZA(),t.TgZ(22,"mat-select",20),t.YNc(23,y,2,2,"mat-option",21),t.qZA(),t.YNc(24,U,5,0,"mat-error",19),t.qZA(),t.TgZ(25,"mat-form-field",17)(26,"mat-label"),t._uU(27,"Book Title"),t.qZA(),t._UZ(28,"input",22),t.YNc(29,E,4,0,"mat-error",19),t.YNc(30,F,4,1,"mat-error",19),t.qZA(),t.TgZ(31,"mat-form-field",17)(32,"mat-label"),t._uU(33,"Book Author"),t.qZA(),t._UZ(34,"input",23),t.YNc(35,q,4,0,"mat-error",19),t.YNc(36,J,4,1,"mat-error",19),t.qZA(),t.TgZ(37,"mat-form-field",17)(38,"mat-label"),t._uU(39,"Book Description"),t.qZA(),t._UZ(40,"textarea",24),t.qZA(),t.TgZ(41,"div",25)(42,"button",26),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.updateBook())}),t._uU(43,"Update"),t.qZA(),t.TgZ(44,"button",27),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.reset())}),t._uU(45,"Reset"),t.qZA()()()()()()}if(2&r){const e=t.oxw();t.xp6(4),t.Q6J("src",e.imageSrc,t.LSH),t.xp6(5),t.Q6J("disabled",!e.selectedFile),t.xp6(3),t.Q6J("formGroup",e.editBookForm),t.xp6(6),t.Q6J("ngIf",(null==e.getBookId?null:e.getBookId.invalid)&&(null==e.getBookId?null:e.getBookId.touched)),t.xp6(4),t.Q6J("compareWith",e.compareCategories),t.xp6(1),t.Q6J("ngForOf",e.categories),t.xp6(1),t.Q6J("ngIf",(null==e.getBookCategory?null:e.getBookCategory.invalid)&&(null==e.getBookCategory?null:e.getBookCategory.touched)),t.xp6(5),t.Q6J("ngIf",(null==e.getBookTitle||null==e.getBookTitle.errors?null:e.getBookTitle.errors.required)&&(null==e.getBookTitle?null:e.getBookTitle.touched)),t.xp6(1),t.Q6J("ngIf",(null==e.getBookTitle||null==e.getBookTitle.errors?null:e.getBookTitle.errors.minlength)&&(null==e.getBookTitle?null:e.getBookTitle.touched)),t.xp6(5),t.Q6J("ngIf",(null==e.getBookAuthor||null==e.getBookAuthor.errors?null:e.getBookAuthor.errors.required)&&(null==e.getBookAuthor?null:e.getBookAuthor.touched)),t.xp6(1),t.Q6J("ngIf",(null==e.getBookAuthor||null==e.getBookAuthor.errors?null:e.getBookAuthor.errors.minlength)&&(null==e.getBookAuthor?null:e.getBookAuthor.touched)),t.xp6(6),t.Q6J("disabled",e.editBookForm.invalid||e.editBookForm.pristine)}}class c{constructor(o,e,i,s,m,G){this.activatedRoute=o,this.bookService=e,this.fb=i,this.categoryService=s,this.storeService=m,this._snackBar=G,this.error=null,this.loaded=!1,this.selectedFile=null}ngOnInit(){this.editBookForm=this.fb.group({id:[null,n.kI.required],category:[null,n.kI.required],title:["",[n.kI.required,n.kI.minLength(3)]],author:["",[n.kI.required,n.kI.minLength(3)]],description:[null]});let o=Number(this.activatedRoute.snapshot.paramMap.get("id"));this.bookService.getBookById(o).subscribe({next:e=>{this.savedBook=e,this.imageSrc=e.imageUrl||"assets/images/default-book-image.jpg",this.fetchValues(e),this.loadCategories(),this.loaded=!0},error:e=>{console.log(e),this.error=e}})}loadCategories(){this.storeService.loaded?this.storeService.loadCategories().subscribe(o=>this.categories=o):this.categoryService.getCategories().subscribe({next:o=>{this.categories=o,this.storeService.setCategories(o)},error:o=>{console.log(o),this.error=o}})}fetchValues(o){this.editBookForm.setValue({id:o.id,category:o.category,title:o.title,author:o.author,description:o.description})}updateBook(){null!==this.error&&(this.error=null),this.bookService.updateBook(this.editBookForm.value).subscribe({next:e=>{this.savedBook=e,this.storeService.modifyBook(e),this._snackBar.open(e.title+" updated successfully!","",{duration:3e3}),this.formGroupDirective.resetForm(),this.fetchValues(this.savedBook)},error:e=>{console.log(e),this.error=e}})}reset(){this.formGroupDirective.resetForm(),this.fileInput.nativeElement.value="",this.selectedFile=null,this.error=null,this.imageSrc=this.savedBook.imageUrl||"assets/images/default-book-image.jpg",this.fetchValues(this.savedBook)}compareCategories(o,e){return o&&e&&o.id===e.id}onFileSelect(o){if(o.target.files){this.selectedFile=o.target.files[0];let e=new FileReader;e.onload=i=>{this.imageSrc=i.target.result},e.readAsDataURL(o.target.files[0])}}updateImage(){console.log(this.selectedFile);let o=this.savedBook.id;this.bookService.saveBookImage(o,this.selectedFile).subscribe({next:i=>{this.savedBook.imageUrl=i.imageUrl,this.storeService.addBookImage(o,i),this._snackBar.open("Image updated successfully!","",{duration:3e3}),this.fileInput.nativeElement.value="",this.selectedFile=null}})}setDefaultImage(o){o.target.src&&(o.target.src="assets/images/default-book-image.jpg")}get getBookTitle(){return this.editBookForm.get("title")}get getBookAuthor(){return this.editBookForm.get("author")}get getBookCategory(){return this.editBookForm.get("category")}get getBookId(){return this.editBookForm.get("id")}}c.\u0275fac=function(o){return new(o||c)(t.Y36(h.gz),t.Y36(v.Z),t.Y36(n.qu),t.Y36(T.H),t.Y36(Z.d),t.Y36(k.ux))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-book-edit"]],viewQuery:function(o,e){if(1&o&&(t.Gf(x,5),t.Gf(C,5)),2&o){let i;t.iGM(i=t.CRH())&&(e.formGroupDirective=i.first),t.iGM(i=t.CRH())&&(e.fileInput=i.first)}},decls:6,vars:2,consts:[[1,"container","bg-white","mt-3","p-3"],[1,"fs-4","fw-bold"],["class","container mt-3 alert alert-danger",4,"ngIf"],["class","container mt-3",4,"ngIf"],[1,"container","mt-3","alert","alert-danger"],[1,"container","mt-3"],[1,"row","align-items-center"],[1,"col-12","col-md-4","align-self-start"],[1,"d-flex","flex-column","mt-3"],["alt","Book Image",1,"img-thumbnail",3,"src","error"],["mat-raised-button","",1,"my-3",3,"click"],["hidden","","type","file",3,"change"],["fileInput",""],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"col-sm-6","col-md-8"],[1,"d-flex","flex-column","bg-white","mt-3","p-3",3,"formGroup"],["formGroupDirective","ngForm"],["appearance","outline",1,"mb-4"],["matInput","","formControlName","id","readonly",""],[4,"ngIf"],["formControlName","category",3,"compareWith"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","title"],["matInput","","formControlName","author"],["matInput","","formControlName","description"],[1,"d-flex","justify-content-between"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click"],["type","button","mat-raised-button","","color","accent",3,"click"],[3,"value"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"p",1),t._uU(2,"Edit book"),t.qZA(),t._UZ(3,"hr"),t.qZA(),t.YNc(4,I,4,2,"div",2),t.YNc(5,S,46,12,"div",3)),2&o&&(t.xp6(4),t.Q6J("ngIf",e.error),t.xp6(1),t.Q6J("ngIf",e.loaded))},dependencies:[d.sg,d.O5,g.KE,g.hX,g.TO,p.Nt,B.gD,A.ey,_.lW,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u]});const N=[{path:"",component:c}];class a{}a.\u0275fac=function(o){return new(o||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[h.Bz.forChild(N),h.Bz]});class u{}u.\u0275fac=function(o){return new(o||u)},u.\u0275mod=t.oAB({type:u}),u.\u0275inj=t.cJS({imports:[d.ez,a,g.lN,p.c,B.LD,_.ot,n.UX,k.ZX]})}}]);