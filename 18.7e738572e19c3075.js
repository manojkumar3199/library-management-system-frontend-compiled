"use strict";(self.webpackChunklibrary_management_system=self.webpackChunklibrary_management_system||[]).push([[18],{2018:(H,h,o)=>{o.r(h),o.d(h,{StudentEditModule:()=>m});var _=o(6895),c=o(9299),l=o(4006),S=o(5439),t=o(4650),T=o(1938),U=o(2882),Z=o(7009),d=o(9549),v=o(4144),I=o(4859),f=o(1948),g=o(9602),x=o(7392);const C=["formGroupDirective"],b=["fileInput"];function A(u,r){if(1&u&&(t.TgZ(0,"div",4)(1,"strong"),t._uU(2,"Error: "),t.qZA(),t._uU(3),t.qZA()),2&u){const n=t.oxw();t.xp6(3),t.AsE("",null==n.error.error?null:n.error.error.error," ",null==n.error.error?null:n.error.error.message,"\n")}}function q(u,r){1&u&&(t.TgZ(0,"mat-error"),t._uU(1," Student Id is "),t.TgZ(2,"strong"),t._uU(3,"Required"),t.qZA()())}function E(u,r){1&u&&(t.TgZ(0,"mat-error"),t._uU(1," Stream is "),t.TgZ(2,"strong"),t._uU(3,"Required"),t.qZA()())}function N(u,r){if(1&u&&(t.TgZ(0,"mat-error"),t._uU(1," Stream Should Have "),t.TgZ(2,"strong"),t._uU(3),t.qZA()()),2&u){const n=t.oxw(2);t.xp6(3),t.hij(" At Least ",null==n.getStudentStream||null==n.getStudentStream.errors||null==n.getStudentStream.errors.minlength?null:n.getStudentStream.errors.minlength.requiredLength," Chars ")}}function Y(u,r){1&u&&(t.TgZ(0,"mat-error"),t._uU(1," Student Name Is "),t.TgZ(2,"strong"),t._uU(3,"Required"),t.qZA()())}function F(u,r){if(1&u&&(t.TgZ(0,"mat-error"),t._uU(1," Student Name Should Have "),t.TgZ(2,"strong"),t._uU(3),t.qZA()()),2&u){const n=t.oxw(2);t.xp6(3),t.hij(" At Least ",null==n.getStudentName||null==n.getStudentName.errors?null:n.getStudentName.errors.minlength.requiredLength," Chars ")}}function J(u,r){1&u&&(t.TgZ(0,"div",39),t._uU(1," Please "),t.TgZ(2,"Strong"),t._uU(3,"Select"),t.qZA(),t._uU(4," Your Gender "),t.qZA())}function D(u,r){1&u&&(t.TgZ(0,"mat-error"),t._uU(1," Date Of Birth Is "),t.TgZ(2,"strong"),t._uU(3,"Required"),t.qZA()())}function M(u,r){1&u&&(t.TgZ(0,"mat-error"),t._uU(1," Contact Number Is "),t.TgZ(2,"strong"),t._uU(3,"Required"),t.qZA()())}function y(u,r){1&u&&(t.TgZ(0,"mat-error")(1,"strong"),t._uU(2,"Invalid"),t.qZA(),t._uU(3," Contact Number "),t.qZA())}function k(u,r){1&u&&(t.TgZ(0,"mat-error"),t._uU(1," Email Is "),t.TgZ(2,"strong"),t._uU(3,"Required"),t.qZA()())}function G(u,r){1&u&&(t.TgZ(0,"mat-error")(1,"strong"),t._uU(2,"Invalid"),t.qZA(),t._uU(3," Email "),t.qZA())}function Q(u,r){if(1&u){const n=t.EpF();t.TgZ(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8),t._UZ(4,"img",9),t.TgZ(5,"button",10),t.NdJ("click",function(){t.CHM(n);const i=t.MAs(8);return t.KtG(i.click())}),t._uU(6,"Browse Image"),t.qZA(),t.TgZ(7,"input",11,12),t.NdJ("change",function(i){t.CHM(n);const p=t.oxw();return t.KtG(p.onFileSelect(i))}),t.qZA(),t.TgZ(9,"button",13),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.updateImage())}),t._uU(10,"Change Image"),t.qZA()()(),t.TgZ(11,"div",14)(12,"form",15,16),t.NdJ("ngSubmit",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.updateStudent())}),t.TgZ(14,"mat-form-field",17)(15,"mat-label"),t._uU(16,"Student Id"),t.qZA(),t._UZ(17,"input",18),t.YNc(18,q,4,0,"mat-error",19),t.qZA(),t.TgZ(19,"mat-form-field",17)(20,"mat-label"),t._uU(21,"Stream"),t.qZA(),t._UZ(22,"input",20),t.YNc(23,E,4,0,"mat-error",19),t.YNc(24,N,4,1,"mat-error",19),t.qZA(),t.TgZ(25,"mat-form-field",17)(26,"mat-label"),t._uU(27,"Name"),t.qZA(),t._UZ(28,"input",21),t.YNc(29,Y,4,0,"mat-error",19),t.YNc(30,F,4,1,"mat-error",19),t.qZA(),t.TgZ(31,"div",22)(32,"mat-radio-group",23)(33,"mat-radio-button",24),t._uU(34,"Male"),t.qZA(),t.TgZ(35,"mat-radio-button",25),t._uU(36,"Female"),t.qZA(),t.TgZ(37,"mat-radio-button",26),t._uU(38,"Other"),t.qZA()(),t.YNc(39,J,5,0,"div",27),t.qZA(),t.TgZ(40,"mat-form-field",17)(41,"mat-label"),t._uU(42,"Date Of Birth"),t.qZA(),t._UZ(43,"input",28)(44,"mat-datepicker-toggle",29)(45,"mat-datepicker",30,31),t.YNc(47,D,4,0,"mat-error",19),t.qZA(),t.TgZ(48,"mat-form-field",17)(49,"mat-label"),t._uU(50,"Contact Number"),t.qZA(),t.TgZ(51,"span",32),t._uU(52,"+91 \xa0"),t.qZA(),t._UZ(53,"input",33),t.TgZ(54,"mat-icon",34),t._uU(55,"call"),t.qZA(),t.YNc(56,M,4,0,"mat-error",19),t.YNc(57,y,4,0,"mat-error",19),t.qZA(),t.TgZ(58,"mat-form-field",17)(59,"mat-label"),t._uU(60,"Email"),t.qZA(),t._UZ(61,"input",35),t.YNc(62,k,4,0,"mat-error",19),t.YNc(63,G,4,0,"mat-error",19),t.qZA(),t.TgZ(64,"div",36)(65,"button",37),t._uU(66,"Update"),t.qZA(),t.TgZ(67,"button",38),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.reset())}),t._uU(68,"Reset"),t.qZA()()()()()()}if(2&u){const n=t.MAs(46),e=t.oxw();t.xp6(4),t.Q6J("src",e.imageSrc,t.LSH),t.xp6(5),t.Q6J("disabled",!e.selectedFile),t.xp6(3),t.Q6J("formGroup",e.editStudentForm),t.xp6(6),t.Q6J("ngIf",(null==e.getStudentId||null==e.getStudentId.errors?null:e.getStudentId.errors.required)&&(null==e.getStudentId?null:e.getStudentId.touched)),t.xp6(5),t.Q6J("ngIf",(null==e.getStudentStream||null==e.getStudentStream.errors?null:e.getStudentStream.errors.required)&&(null==e.getStudentStream?null:e.getStudentStream.touched)),t.xp6(1),t.Q6J("ngIf",(null==e.getStudentStream||null==e.getStudentStream.errors?null:e.getStudentStream.errors.minlength)&&(null==e.getStudentStream?null:e.getStudentStream.touched)),t.xp6(5),t.Q6J("ngIf",(null==e.getStudentName||null==e.getStudentName.errors?null:e.getStudentName.errors.required)&&(null==e.getStudentName?null:e.getStudentName.touched)),t.xp6(1),t.Q6J("ngIf",(null==e.getStudentName||null==e.getStudentName.errors?null:e.getStudentName.errors.minlength)&&(null==e.getStudentName?null:e.getStudentName.touched)),t.xp6(9),t.Q6J("ngIf",(null==e.getStudentGender?null:e.getStudentGender.invalid)&&(null==e.getStudentGender?null:e.getStudentGender.touched)),t.xp6(4),t.Q6J("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(3),t.Q6J("ngIf",(null==e.getStudentDob||null==e.getStudentDob.errors?null:e.getStudentDob.errors.required)&&(null==e.getStudentDob?null:e.getStudentDob.touched)),t.xp6(9),t.Q6J("ngIf",(null==e.getStudentContact||null==e.getStudentContact.errors?null:e.getStudentContact.errors.required)&&(null==e.getStudentContact?null:e.getStudentContact.touched)),t.xp6(1),t.Q6J("ngIf",(null==e.getStudentContact||null==e.getStudentContact.errors?null:e.getStudentContact.errors.pattern)&&(null==e.getStudentContact?null:e.getStudentContact.touched)),t.xp6(5),t.Q6J("ngIf",(null==e.getStudentEmail||null==e.getStudentEmail.errors?null:e.getStudentEmail.errors.required)&&(null==e.getStudentEmail?null:e.getStudentEmail.touched)),t.xp6(1),t.Q6J("ngIf",(null==e.getStudentEmail||null==e.getStudentEmail.errors?null:e.getStudentEmail.errors.pattern)&&(null==e.getStudentEmail?null:e.getStudentEmail.touched)),t.xp6(2),t.Q6J("disabled",e.editStudentForm.invalid||e.editStudentForm.pristine)}}class s{constructor(r,n,e,i,p){this.activatedRoute=r,this.studentService=n,this.fb=e,this.storeService=i,this._snackBar=p,this.error=null,this.loaded=!1,this.selectedFile=null}ngOnInit(){this.editStudentForm=this.fb.group({id:[null,l.kI.required],stream:[null,[l.kI.required,l.kI.minLength(2)]],name:[null,[l.kI.required,l.kI.minLength(3)]],gender:[null,l.kI.required],dob:[null,l.kI.required],contact:[null,[l.kI.required,l.kI.pattern("^[7-9][0-9]{9}$")]],email:[null,[l.kI.required,l.kI.pattern("^[a-z0-9](.?[a-z0-9]){5,}@g(oogle)?mail.com$")]]});let r=Number(this.activatedRoute.snapshot.paramMap.get("id"));this.studentService.getStudentById(r).subscribe({next:n=>{this.savedStudent=n,this.imageSrc=n.imageUrl||"assets/images/default-student-image.png",this.fetchValues(n),this.loaded=!0},error:n=>{console.log(n),this.error=n}})}fetchValues(r){this.editStudentForm.setValue({id:r.id,stream:r.stream,name:r.name,gender:r.gender,dob:S(r.dob,"DD-MM-YYYY").toDate(),contact:r.contact,email:r.email})}updateStudent(){null!==this.editStudentForm.value.dob&&S(this.editStudentForm.value.dob,"DD-MM-YYYY").format("DD-MM-YYYY")!==this.editStudentForm.value.dob&&(this.editStudentForm.value.dob=S(this.editStudentForm.value.dob).format("DD-MM-YYYY")),null!==this.error&&(this.error=null),this.studentService.updateStudent(this.editStudentForm.value).subscribe({next:n=>{this.savedStudent=n,this.storeService.modifyStudent(n),this._snackBar.open(n.name+" updated successfully!","",{duration:3e3}),this.formGroupDirective.resetForm(),this.fetchValues(this.savedStudent)},error:n=>{console.log(n),this.error=n}})}reset(){this.formGroupDirective.resetForm(),this.fileInput.nativeElement.value="",this.selectedFile=null,this.error=null,this.imageSrc=this.savedStudent.imageUrl||"assets/images/default-student-image.png",this.fetchValues(this.savedStudent)}onFileSelect(r){if(r.target.files){this.selectedFile=r.target.files[0];let n=new FileReader;n.onload=e=>{this.imageSrc=e.target.result},n.readAsDataURL(r.target.files[0])}}updateImage(){let r=this.savedStudent.id;this.studentService.saveStudentImage(r,this.selectedFile).subscribe({next:e=>{this.savedStudent.imageUrl=e.imageUrl,this.storeService.addStudentImage(r,e),this._snackBar.open("Image updated successfully!","",{duration:3e3}),this.fileInput.nativeElement.value="",this.selectedFile=null}})}get getStudentId(){return this.editStudentForm.get("id")}get getStudentStream(){return this.editStudentForm.get("stream")}get getStudentName(){return this.editStudentForm.get("name")}get getStudentGender(){return this.editStudentForm.get("gender")}get getStudentDob(){return this.editStudentForm.get("dob")}get getStudentContact(){return this.editStudentForm.get("contact")}get getStudentEmail(){return this.editStudentForm.get("email")}}s.\u0275fac=function(r){return new(r||s)(t.Y36(c.gz),t.Y36(T.V),t.Y36(l.qu),t.Y36(U.d),t.Y36(Z.ux))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-student-edit"]],viewQuery:function(r,n){if(1&r&&(t.Gf(C,5),t.Gf(b,5)),2&r){let e;t.iGM(e=t.CRH())&&(n.formGroupDirective=e.first),t.iGM(e=t.CRH())&&(n.fileInput=e.first)}},decls:6,vars:2,consts:[[1,"container","bg-white","mt-3","p-3"],[1,"fs-4","fw-bold"],["class","container mt-3 alert alert-danger",4,"ngIf"],["class","container mt-3",4,"ngIf"],[1,"container","mt-3","alert","alert-danger"],[1,"container","mt-3"],[1,"row","align-items-center"],[1,"col-12","col-md-4","align-self-start"],[1,"d-flex","flex-column","mt-3"],["alt","Book Image",1,"img-thumbnail",3,"src"],["mat-raised-button","",1,"my-3",3,"click"],["hidden","","type","file",3,"change"],["fileInput",""],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"col-sm-6","col-md-8"],[1,"d-flex","flex-column","bg-white","mt-3","p-3",3,"formGroup","ngSubmit"],["formGroupDirective","ngForm"],["appearance","outline",1,"mb-4"],["matInput","","placeholder","e.g: Bsc","formControlName","id"],[4,"ngIf"],["matInput","","placeholder","e.g: Bsc","formControlName","stream"],["matInput","","placeholder","e.g: Akash Sathi","formControlName","name"],[1,"d-flex","flex-column","align-items-center","mb-5"],["formControlName","gender"],["value","male"],["value","female"],["value","others"],["class","text-danger",4,"ngIf"],["matInput","","formControlName","dob","placeholder","MM/DD/YYYY",3,"matDatepicker"],["matIconSuffix","",3,"for"],["startView","multi-year"],["picker",""],["matPrefix",""],["type","tel","matInput","","placeholder","9857478744","formControlName","contact"],["matSuffix",""],["matInput","","placeholder","e.g: akashsathi@gmail.com","formControlName","email","readonly",""],[1,"d-flex","justify-content-between"],["type","submit","mat-raised-button","","color","primary",3,"disabled"],["type","button","mat-raised-button","","color","accent",3,"click"],[1,"text-danger"]],template:function(r,n){1&r&&(t.TgZ(0,"div",0)(1,"p",1),t._uU(2,"Edit Student"),t.qZA(),t._UZ(3,"hr"),t.qZA(),t.YNc(4,A,4,2,"div",2),t.YNc(5,Q,69,17,"div",3)),2&r&&(t.xp6(4),t.Q6J("ngIf",n.error),t.xp6(1),t.Q6J("ngIf",n.loaded))},dependencies:[_.O5,d.KE,d.hX,d.TO,d.qo,d.R9,v.Nt,I.lW,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,f.VQ,f.U0,g.Mq,g.hl,g.nW,x.Hw]});const R=[{path:"",component:s}];class a{}a.\u0275fac=function(r){return new(r||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[c.Bz.forChild(R),c.Bz]});var B=o(3238);class m{}m.\u0275fac=function(r){return new(r||m)},m.\u0275mod=t.oAB({type:m}),m.\u0275inj=t.cJS({imports:[_.ez,a,d.lN,v.c,I.ot,l.UX,Z.ZX,f.Fk,g.FA,B.XK,x.Ps]})}}]);